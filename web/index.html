<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>上海圣思--考勤报表转换</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="layui/css/layui.css" media="all">
    <style>
        #box {
            text-align: center;
        }
    </style>
</head>
<body>
<div id="box">
    <form class="layui-form" action="upload" enctype="multipart/form-data" method="post">
        <h1>考勤报表转换</h1>
        <button type="button" class="layui-btn" id="button">
            <i class="layui-icon layui-icon-upload-circle"></i>上传签到数据
        </button>
        <button type="button" class="layui-btn layui-btn-disabled" id="download" disabled="disabled">
            <i class="layui-icon layui-icon-download-circle"></i>下载考勤报表
        </button>
    </form>
</div>
<table class="layui-hide" id="report"></table>
<script src="layui/layui.js"></script>
<script>
    var download = document.getElementById("download");
    download.onclick = function () {
        var aElement = document.createElement("a");
        aElement.download = "考勤报表.xls";
        aElement.href = 'upload';
        aElement.click();
    };

    layui.use('upload', function () {
        var upload = layui.upload;

        //执行实例
        upload.render({
            elem: '#button',
            url: 'upload',
            accept: 'file',
            acceptMime: 'application/vnd.ms-excel',
            exts: 'xls',
            before: function () {
                layer.closeAll();
                layer.load(); //上传loading
            },
            done: function (res) {
                if (res.code === '1') {
                    layer.closeAll('loading'); //关闭loading
                    layui.use('table', function () {
                        var table = layui.table;
                        table.render({
                            elem: '#report',
                            // toolbar: true,
                            // defaultToolbar: ['exports', 'print'],
                            data: res.data,
                            title: '考勤定义表',
                            cellMinWidth: 100,
                            page: false,
                            height: 'full-100',
                            limit: 100,
                            cols: [[
                                {colspan: '2', align: 'center'},
                                {colspan: '2', align: 'center', title: '1'},
                                {colspan: '2', align: 'center', title: '2'},
                                {colspan: '2', align: 'center', title: '3'},
                                {colspan: '2', align: 'center', title: '4'},
                                {colspan: '2', align: 'center', title: '5'},
                                {colspan: '2', align: 'center', title: '6'},
                                {colspan: '2', align: 'center', title: '7'},
                                {colspan: '2', align: 'center', title: '8'},
                                {colspan: '2', align: 'center', title: '9'},
                                {colspan: '2', align: 'center', title: '10'},
                                {colspan: '2', align: 'center', title: '11'},
                                {colspan: '2', align: 'center', title: '12'},
                                {colspan: '2', align: 'center', title: '13'},
                                {colspan: '2', align: 'center', title: '14'},
                                {colspan: '2', align: 'center', title: '15'},
                                {colspan: '2', align: 'center', title: '16'},
                                {colspan: '2', align: 'center', title: '16'},
                                {colspan: '2', align: 'center', title: '18'},
                                {colspan: '2', align: 'center', title: '19'},
                                {colspan: '2', align: 'center', title: '20'},
                                {colspan: '2', align: 'center', title: '21'},
                                {colspan: '2', align: 'center', title: '22'},
                                {colspan: '2', align: 'center', title: '23'},
                                {colspan: '2', align: 'center', title: '24'},
                                {colspan: '2', align: 'center', title: '25'},
                                {colspan: '2', align: 'center', title: '26'},
                                {colspan: '2', align: 'center', title: '27'},
                                {colspan: '2', align: 'center', title: '28'},
                                {colspan: '2', align: 'center', title: '29'},
                                {colspan: '2', align: 'center', title: '30'},
                                {colspan: '2', align: 'center', title: '31'}
                            ], [
                                {field: 'name', title: '姓名', align: 'center', sort: true, fixed: 'left'},
                                {field: 'depart', title: '部门', align: 'center', sort: true, fixed: 'left'},
                                {field: 'm1', align: 'center', title: '上午'},
                                {field: 'a1', align: 'center', title: '下午'},
                                {field: 'm2', align: 'center', title: '上午'},
                                {field: 'a2', align: 'center', title: '下午'},
                                {field: 'm3', align: 'center', title: '上午'},
                                {field: 'a3', align: 'center', title: '下午'},
                                {field: 'm4', align: 'center', title: '上午'},
                                {field: 'a4', align: 'center', title: '下午'},
                                {field: 'm5', align: 'center', title: '上午'},
                                {field: 'a5', align: 'center', title: '下午'},
                                {field: 'm6', align: 'center', title: '上午'},
                                {field: 'a6', align: 'center', title: '下午'},
                                {field: 'm7', align: 'center', title: '上午'},
                                {field: 'a7', align: 'center', title: '下午'},
                                {field: 'm8', align: 'center', title: '上午'},
                                {field: 'a8', align: 'center', title: '下午'},
                                {field: 'm9', align: 'center', title: '上午'},
                                {field: 'a9', align: 'center', title: '下午'},
                                {field: 'm10', align: 'center', title: '上午'},
                                {field: 'a10', align: 'center', title: '下午'},
                                {field: 'm11', align: 'center', title: '上午'},
                                {field: 'a11', align: 'center', title: '下午'},
                                {field: 'm12', align: 'center', title: '上午'},
                                {field: 'a12', align: 'center', title: '下午'},
                                {field: 'm13', align: 'center', title: '上午'},
                                {field: 'a13', align: 'center', title: '下午'},
                                {field: 'm14', align: 'center', title: '上午'},
                                {field: 'a14', align: 'center', title: '下午'},
                                {field: 'm15', align: 'center', title: '上午'},
                                {field: 'a15', align: 'center', title: '下午'},
                                {field: 'm16', align: 'center', title: '上午'},
                                {field: 'a16', align: 'center', title: '下午'},
                                {field: 'm17', align: 'center', title: '上午'},
                                {field: 'a17', align: 'center', title: '下午'},
                                {field: 'm18', align: 'center', title: '上午'},
                                {field: 'a18', align: 'center', title: '下午'},
                                {field: 'm19', align: 'center', title: '上午'},
                                {field: 'a19', align: 'center', title: '下午'},
                                {field: 'm20', align: 'center', title: '上午'},
                                {field: 'a20', align: 'center', title: '下午'},
                                {field: 'm21', align: 'center', title: '上午'},
                                {field: 'a21', align: 'center', title: '下午'},
                                {field: 'm22', align: 'center', title: '上午'},
                                {field: 'a22', align: 'center', title: '下午'},
                                {field: 'm23', align: 'center', title: '上午'},
                                {field: 'a23', align: 'center', title: '下午'},
                                {field: 'm24', align: 'center', title: '上午'},
                                {field: 'a24', align: 'center', title: '下午'},
                                {field: 'm25', align: 'center', title: '上午'},
                                {field: 'a25', align: 'center', title: '下午'},
                                {field: 'm26', align: 'center', title: '上午'},
                                {field: 'a26', align: 'center', title: '下午'},
                                {field: 'm27', align: 'center', title: '上午'},
                                {field: 'a27', align: 'center', title: '下午'},
                                {field: 'm28', align: 'center', title: '上午'},
                                {field: 'a28', align: 'center', title: '下午'},
                                {field: 'm29', align: 'center', title: '上午'},
                                {field: 'a29', align: 'center', title: '下午'},
                                {field: 'm30', align: 'center', title: '上午'},
                                {field: 'a30', align: 'center', title: '下午'},
                                {field: 'm31', align: 'center', title: '上午'},
                                {field: 'a31', align: 'center', title: '下午'}
                            ]]
                        });
                    });
                    download.className = 'layui-btn';
                    download.disabled = "";
                } else {
                    layer.msg('上传失败');
                }
            },
            error: function () {
                layer.closeAll('loading'); //关闭loading
            }
        });
    });
</script>
</body>
</html>
